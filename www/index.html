<!DOCTYPE html>
<html>
	<head>
		<meta name="viewport"
			  content="user-scalable=no, initial-scale=1, maximum-scale=1,
					   minimum-scale=1, width=device-width">
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<meta http-equiv="Content-Security-Policy"
			  content="default-src 'self' 'unsafe-inline' 'unsafe-eval'">
		<title>Canicalm Smart</title>
		<link rel="stylesheet" type="text/css" href="./css/styles.css">
		<link rel="stylesheet" href="./css/jquery-ui.css">
		<link rel="stylesheet" href="./css/sweetalert2.css">
		<link rel="icon" type="image/x-icon" href="/img/favicon.ico">
		<link rel="apple-touch-icon" sizes="57x57"
			  href="/img/apple-touch-icon-57x57.png">
		<link rel="apple-touch-icon" sizes="114x114"
			  href="/img/apple-touch-icon-114x114.png">
		<link rel="apple-touch-icon" sizes="72x72"
			  href="/img/apple-touch-icon-72x72.png">
		<link rel="apple-touch-icon" sizes="144x144"
			  href="/img/apple-touch-icon-144x144.png">
		<link rel="apple-touch-icon" sizes="60x60"
			  href="/img/apple-touch-icon-60x60.png">
		<link rel="apple-touch-icon" sizes="120x120"
			  href="/img/apple-touch-icon-120x120.png">
		<link rel="apple-touch-icon" sizes="76x76"
			  href="/img/apple-touch-icon-76x76.png">
		<link rel="apple-touch-icon" sizes="152x152"
			  href="/img/apple-touch-icon-152x152.png">
		<style type="text/css">
			/* Override some lib parameters */
			.ui-datepicker {
				/*what ever width you want*/
				width: calc(100% - 9px);
			}

			.ui-datepicker-title {
				background: none;
				width: calc(100% - 4.6em);
			}

			/*.ui-datepicker-header{
				background-repeat: repeat-x;
				background-image: url("./img/bg-dark.png");
			}*/
			.ui-datepicker-header {
				background-repeat: repeat-x;
				background-image: url("./img/bg-dark.png");
				background-size: auto 100%;
				color: #f89e25;
			}

			.ui-datepicker-next .ui-icon-circle-triangle-e {
				background-image: url("./img/next.svg");
				background-position: center center;
				background-size: contain;
			}

			.ui-datepicker-prev .ui-icon-circle-triangle-w {
				background-image: url("./img/prev.svg");
				background-position: center center;
				background-size: contain;
			}

			.ui-datepicker-current-day,
			.ui-datepicker-today {}

			.ui-widget-content .ui-state-highlight {
				border: none;
				background-repeat: repeat-x;
				background-image: url("./img/bg-dark.png");
				background-size: auto 100%;
				color: #f89e25;
			}

			.ui-widget-content .ui-state-default {
				text-align: center;
			}

			.swal2-title,
			#swal2-title {
				font-family: Karla;
				font-size: 25px;
				line-height: 50px;
				color: #333;
			}

			.swal2-icon.swal2-warning {
				color: #f89e25;
				border-color: #f89e25;
			}

			/*.ui-datepicker-month{
				border-radius: 4px 0 0 4px;
				margin-right:5px;
			}
			.ui-datepicker-year{
				border-radius: 0 4px 4px 0;
				margin-left:5px;
			}*/
		</style>

		<script type="text/javascript"
				src="./js/promise-polyfill.min.js"></script>
		<script type="text/javascript" src="./js/jquery-min.js"></script>
		<script type="text/javascript" src="./cordova.js"></script>
		<script type="text/javascript"
				src="./js/jquery.transit.min.js"></script>
		<script type="text/javascript" src="./js/app-init.js"></script>
		<script type="text/javascript" src="./js/jquery-ui.min.js"></script>
		<script type="text/javascript"
				src="./js/jqueryui-touch-min.js"></script>
		<script type="text/javascript" src="./js/sweetalert2.js"></script>
		<script type="text/javascript"
				src="./js/lang/datepicker/datepicker-fr.js"></script>
		<script type="text/javascript"
				src="./js/lang/datepicker/datepicker-de.js"></script>
		<script type="text/javascript"
				src="./js/lang/datepicker/datepicker-es.js"></script>
		<script type="text/javascript"
				src="./js/lang/datepicker/datepicker-it.js"></script>
		<script type="text/javascript" src="./js/dataManager.js"></script>
		<script type="text/javascript" src="./js/lang/lang.js"></script>
		<script type="text/javascript" src="./js/ble.js"></script>
		<script type="text/javascript" src="./js/processAsso.js"></script>
		<script type="text/javascript">
			// fil d'ariane pour le back button des mobiles
			var breadcrumb = [];
			var currentPage = "index";
			var notFirstUse = false;
			var simuleAndroid = -1;

			$(function() {
				breadcrumb.push("index");
				document.addEventListener("backbutton", goBack, false);

				notFirstUse = loadUserProperties();

				OnAppStartInit(notFirstUse);

				PARSE_BodyLanguage();

/*				screen.orientation.lock("landscape").
					then(function() {
						alert('Locked');
					})
					.catch(function(error) {
						alert("Erreur : " + error);
					}); */
				OrientationSizeChange();

				InitDB();

				BLEisWaitingAppInit();

				if (screen == null || screen.orientation == null ||
					screen.orientation.onchange === undefined) {
					window.addEventListener('orientationchange',
											OrientationSizeChange, true);
//					console.log("orientationchange")
				} else {
					screen.orientation.onchange = OrientationSizeChange;
//					console.log("screen.orientation.onchange")
				}


				if (window.onresize === undefined) {
					window.addEventListener('resize', OrientationSizeChange,
											true);
//					console.log("resize")
				} else {
					window.onresize = OrientationSizeChange;
//					console.log("windows.onresize")
				}
			});

			/*!
			 * variable globale permettant de vérifier à intervalle régulier si
			 * le BLE est toujours actif
			 */
			var AnimalAssociation_Timeout = null;

			/*!
			 * permet d'ajouter un collier à l'utilisateur, lance la procédure
			 * de recherche BLE et gère l'association au compte
			 * \fn DogAdding()
			 */
			function DogAdding() {
				associationSearchDeviceCanicalm();
				swal({
					title: "",
					html:
						LangItem("CS000024") +
						'<br><div style="width:100%; text-align:center; ' +
										'margin-top:20px;">' +
								'<img class="spin" width="40" ' +
									 'src="./img/refresh.svg" />' +
							'</div>',
					onOpen: function() {
						AnimalAssociation_Timeout = setTimeout(function() {
//							console.log("Platform : " + device.platform);
							if (device.platform == "browser") {
								clearTimeout(AnimalAssociation_Timeout);
								scanning = false;
								ble.stopScan();
								timeUpdated = false;
								console.log("---Simulate Device found");
								var dog = {
									name: "Collier1",
									batt: 20,
									id: "1122334455",
									detectionLevel: 60,
									schedule : {
										monday      : [0,0,0,0,0,0,0,0,0,0,0,0,
													   0,0,0,0,0,0,0,0,0,0,0,0],
										tuesday     : [0,0,0,0,0,0,0,0,0,0,0,0,
													   0,0,0,0,0,0,0,0,0,0,0,0],
										wednesday   : [0,0,0,0,0,0,0,0,0,0,0,0,
													   0,0,0,0,0,0,0,0,0,0,0,0],
										thursday    : [0,0,0,0,0,0,0,0,0,0,0,0,
													   0,0,0,0,0,0,0,0,0,0,0,0],
										friday      : [0,0,0,0,0,0,0,0,0,0,0,0,
													   0,0,0,0,0,0,0,0,0,0,0,0],
										saturday    : [0,0,0,0,0,0,0,0,0,0,0,0,
													   0,0,0,0,0,0,0,0,0,0,0,0],
										sunday      : [0,0,0,0,0,0,0,0,0,0,0,0,
													   0,0,0,0,0,0,0,0,0,0,0,0],
									}
								};
								user.dogs.push(dog);
								saveDataToStorage("user", user);

								selectedDog = user.dogs.length -1;
								CreateAndCheckTableIntoDB();
								currentTimestampUsed = Date.now();
								LoadPage("accueil");
								initBLEConnection();
								BLECurrentlyConnected = !BLECurrentlyConnected;
								UpdateConnectionStatusIcon();
								UpdateBatteryIcon(user.dogs[selectedDog].batt);
								$(".param-overlay").css({
									display: "none"
								});
								return;
							}
							swal({
								html:
									LangItem("CS000025") +
									"<br>" +
									LangItem("CS000026") +
									AddCloseIcoForSwal(),
								confirmButtonColor: "#ddd",
								onOpen: function() {
									// permet de désactiver le focus sur le
									// bouton activé automatiquement par la lib
									document.activeElement.blur();
									$(".swal2-confirm").css({
										// modification du style du bouton
										// changé dynamiquement par la lib
										color: "#000",
										"box-shadow": "0 2px 6px #ccc",
										background:
											"linear-gradient(#ffffff, " +
															"#fcfcfc 40%, " +
															"#f1f0f1 80%, " +
															"#e6e6e6)",
										border: "1px solid #aaa",
										"border-radius": "5px"
									});
								},
								showConfirmButton: true
							}).then(function(result) {
								clearTimeout(AnimalAssociation_Timeout);
								swal.close(); // on ferme la popup
								window.location = "index.html";
							});
						}, AnimalAssociation_Duration);
					},
					showConfirmButton: false
				});
			}

			/*!
			 * permet de sélectionner un animal à partir son index dans le
			 * tableau dogs, lance la page accueil et la recherche BLE du
			 * device.
			 * \fn DogSelection(index)
			 * \param integer index relatif au chien à sélectionner dans le
			 * 				  tableau dogs
			 */
			function DogSelection(index) {
				if (selectedDog == -1) {
					clearTimeout(AnimalAssociation_Timeout);
					selectedDog = index;
					CreateAndCheckTableIntoDB();
					currentTimestampUsed = Date.now();
					LoadPage("accueil");
					initBLEConnection();
				} else {
					console.log("DogSelection : " + selectedDog + "=>" + index)
				}
			}

			/*!
			 * intialise la page de démarrage de l'application.
			 * \fn OnAppStartInit(_notFirstUse)
			 * \param boolean _notFirstUse retour de la lecture des données
			 *				  utilisateur, indique si des données on déjà été
			 *				  enregistrées i.e. ce n'est pas le premier
			 *				  démarrage de l'application
			 */
			function OnAppStartInit(_notFirstUse) {
				$(".entry-top").css({
					height: $(window).innerHeight() / 2 + "px"
				});

				if (_notFirstUse == false) {
					// première utilisation de l'application
					content =
						'<button class="item input-select select-lang" ' +
								'name="select-lang">' +
							'<img src="./img/fr.png" />' +
							'<span>Français</span>' +
						'</button>';
					$("#entry-content").append(content);
					AddLanguageSeletor(".select-lang");
					content =
						'<button class="item input-next" name="next" ' +
								'onclick="LoadPage(\'index\');">' +
							'<i name="CS000001">Suivant</i>' +
						'</button>';

					$("#entry-content").append(content);
				} else {
					renderDogList();
				}
			}

			/*!
			 * modifie la page du démarrage de l'application pour permettre de
			 * choisir et/ou d'ajouter un chien.
			 * \fn renderDogList()
			 */
			function renderDogList() {
//				console.log("renderDogList()");
				_notFirstUse = true;
				content = "";
				$("#entry-content").html("");

				if (user.dogs.length > 0) {
					content =
						'<button class="item input-select select-dog" ' +
								'name="select-dog">' +
							'<i name="CS000002">Je choisis un chien</i>' +
						'</button>';
					$("#entry-content").append(content);

					content =
						'<div class="input-select-lang-deployed-content">';
					for (var i = 0; i < user.dogs.length; i++) {
						content +=
							'<div onclick="DogSelection(' + i + ');">' +
								user.dogs[i].name
							"</div>";
					}
					content += "</div>";

					BindEventToSelectItem(".select-dog", content);
				}
				content =
					'<button class="item input-add" name="add-dog" ' +
							'onclick="DogAdding();">' +
						'<i name="CS000003">J\'ajoute un chien</i>' +
					'</button>';

				$("#entry-content").append(content);

				content =
					'<button class="item input-select select-lang" ' +
							'name="select-lang">' +
						'<img src="./img/fr.png" />' +
						'<span>Français</span>' +
					'</button>';
				$("#entry-content").append(content);
				AddLanguageSeletor(".select-lang");
			}

			/*!
			 * permet d'affecter un contenu à un select personnalisé sur un
			 * évènement "click"
			 * \fn BindEventToSelectItem(item, content)
			 * \param string item élément select à affecter
			 * \param string content contenu de la liste du select
			 */
			function BindEventToSelectItem(item, content) {
				$(item).click(function() {
					// ajout de l'évènement click au select personnalisé pointé
					if ($(this).hasClass("input-select-deployed") == true) {
						// si la liste est déjà déployée
						// suppression de la classe "liste déployée"
						$(this).removeClass("input-select-deployed");
						$(this)
							.find("div:first")
							.remove(); // suppression dela liste
					} else {
						// ajout de la classe "liste déployée"
						$(this).addClass("input-select-deployed");
						$(this).append(content); // ajout de la liste
					}
				});
			}

			/*!
			 * permet d'ajouter un sélecteur de langue en fin du conteneur passé
			 * en paramètre
			 * \fn AddLanguageSeletor(_div)
			 * \param string _div élément auquel on ajoute le selecteur de
			 *					  langue. !! nécessite une construction html
			 *					  particulière !!
			 */
			function AddLanguageSeletor(_div) {
				$(_div)
					.find("span:first")
					.html(langTab[user.lang]);
				$(_div)
					.find("img:first")
					.attr("src", "./img/" + user.lang + ".png");
				var content =
					'<div class="input-select-lang-deployed-content">' +
						'<div class="lang-item" name="fr" ' +
							 'onclick="LanguageSelection(this);">' +
							'<img src="./img/fr.png" />' +
							'<span>Français</span>' +
						'</div>' +
						'<div class="lang-item" name="de" ' +
							 'onclick="LanguageSelection(this);">' +
							'<img src="./img/de.png" />' +
							'<span>Deutsch</span>' +
						'</div>' +
						'<div class="lang-item" name="en" ' +
							 'onclick="LanguageSelection(this);">' +
							'<img src="./img/en.png" />' +
							'<span>English</span>' +
						'</div>' +
						'<div class="lang-item" name="es" ' +
							 'onclick="LanguageSelection(this);">' +
							'<img src="./img/es.png" />' +
							'<span>Español</span>' +
						'</div>' +
						'<div class="lang-item" name="it" ' +
							 'onclick="LanguageSelection(this);">' +
							'<img src="./img/it.png" />' +
							'<span>Italiano</span>' +
						'</div>' +
					"</div>";
				BindEventToSelectItem(_div, content);
			}

			/*!
			 * permet de changer la langue de l'application, enregistre le
			 * paramètre dans le cache de l'application
			 * \fn LanguageSelection(_this)
			 * \param object _this élèment pointant le select personnalisé pour
			 * 					   la sélection de la langue
			 */
			function LanguageSelection(_this) {
				// suppression de la classe "liste déployée"
				$(".input-select-lang-deployed-content")
					.removeClass("input-select-deployed");
				// suppression de la liste
				$(".input-select-lang-deployed-content")
					.find("div:first")
					.remove();
				// suppression de la liste du select
				$(".input-select-lang-deployed-content").remove();
				// récupération de la langue suivant l'attribut "name" de
				// l'élément sélectionné
				user.lang = $(_this).attr("name");
				// enregistrement du changement dans le cache de l'application
				saveDataToStorage("user", user);
				// remplacement de la valeur du select
				$(".select-lang").html($(_this).html());
				// correction de la langue sur la page en cours
				PARSE_BodyLanguage();
			}

			/*!
			 * permet de charger les différentes pages applicatives
			 * \fn LoadPage(page)
			 * \param string page clef de sélection de la page permettant
			 *					  d'exécuter une requête en local et remplacer
			 *					  le contenu d'une section par la réponse
			 */
			function LoadPage(page) {
				currentPage = page;
				// on ajoute la page en cours au fil d'ariane
				breadcrumb.push(page);
				if (page == "index") {
					// page index, charge les propriétés de l'utilisateur
					if (BLECurrentlyConnected == true) {
						ble.disconnect(
							user.dogs[selectedDog].id,
							function() {
								// redirection complète, efface les variables js
								// en cache
								window.location = "index.html";
								//Log.v("----> disconnected");
								console.log("----> disconnected");
							},
							function() {
								// redirection complète, efface les variables js
								// en cache
								window.location = "index.html";
								//Log.v("----> disconnection failed");
								console.log("----> disconnection failed");
							}
						);
					} else {
						// redirection complète, efface les variables js en
						// cache
						window.location = "index.html";
					}
					OrientationSizeChange();
				} else {
					$.ajax({
						// on charge dynamiquement la page
						url: page + ".html",
						method: "get",
						success: function(data) {
							// chargement OK (la page existe en local)
							if (!document.getElementById("main-container")) {
/*								var content =
									'<div id="main-container"></div>' +
									'<div class="bottom-bar">' +
										'<img class="bottom-bar-img-out" ' +
											 'src="./img/out.svg" ' +
											 'onclick="LoadPage(\'index\');" ' +
											 '/>' +
										'<span>' +
											'<img id="dog-paw" ' +
												 'src="./img/dog-paw.svg" ' +
												 'onclick="demoConnect();" />' +
										'</span>' +
										'<span>' +
											'<img id="battery-gauge" ' +
												 'src="./img/' +
													  'battery-gauge.svg" />' +
										'</span>' +
										'<span>' +
											'<img id="conection-status" ' +
												 'src="./img/check.svg" />' +
										'</span>' +
									"</div>";
								// remplacement du contenu du body
								$("body").html(content); */
								UpdateConnectionStatusIcon();
							}
							// mise à jout du contenu du conteneur principal
							$("#main-container").html(data);
							OrientationSizeChange();

							// on complète les informations de langues sur la
							// page chargée
							PARSE_BodyLanguage();
						}
					});
				}
			}

			/*!
			 * permet de passer outre le fonctionnement la touche retour du
			 * mobile, remplacement par le chargement de la page précédente
			 * \fn goBack()
			 */
			function goBack() {
				if (breadcrumb.length > 1) {
					// si on a au moins visité 2 pages
					// on retire la page en cours
					breadcrumb.pop();
					// on charge la page précédente
					LoadPage(breadcrumb[breadcrumb.length - 1]);
					OrientationSizeChange();
				}
			}

			/*!
			 * permet d'actualiser l'icône de batterie suivant la valeur lue
			 * dans le dispositif
			 * \fn UpdateBatteryIcon()
			 * \param integer _batt valeur représentant la capacité restant dans
			 *						la battery du Canicalm Smart
			 */
			function UpdateBatteryIcon(_batt) {
				console.log(_batt);
				if (_batt == -1) {
					$("#battery-gauge")
						.parent()
						.css({
							display: "none"
						});
				} else {
					switch (true) {
						case _batt < 20:
							$("#battery-gauge").attr("src",
													 "./img/batt-0.svg");
							break;
						case _batt < 40:
							$("#battery-gauge").attr("src",
													  "./img/batt-20.svg");
							break;
						case _batt < 60:
							$("#battery-gauge").attr("src",
													 "./img/batt-40.svg");
							break;
						case _batt < 80:
							$("#battery-gauge").attr("src",
													 "./img/batt-60.svg");
							break;
						default:
							$("#battery-gauge").attr("src",
													 "./img/batt-80.svg");
							break;
					}
					$("#battery-gauge")
						.parent()
						.css({
							display: "inline-block"
						});
				}
			}

			/*!
			 * variable globale permettant de vérifier à intervalle l'état si des
			 * échanges BLE ont lieu
			 */
			var ConnectionStatus_Timeout = null;

			/*!
			 * variable globale Fixant la durée de l'intervalle de vérification des
			 * échanges BLE
			 */
			var ConnectionStatus_Duration = 3000;

			/*!
			 * permet de gérer l'affichage du status de la connexion BLE au Canicalm
			 * Smart, loader => échanges en cours, check => plus d'échange depuis 3s
			 * \fn UpdateConnectionStatusIcon()
			 */
			function UpdateConnectionStatusIcon() {
				clearTimeout(ConnectionStatus_Timeout);
				if (BLECurrentlyConnected == true) {
					$("#dog-paw").css({
						opacity: "1"
					});
					$("#conection-status")
						.parent()
						.css({
							display: "inline-block"
						});
					if ($("#conection-status").hasClass("spin") == false) {
						$("#conection-status")
							.attr("src", "./img/refresh.svg")
							.addClass("spin");
					}
					ConnectionStatus_Timeout = setTimeout(function() {
						$("#conection-status")
							.removeClass("spin")
							.attr("src", "./img/check.svg");
						if (currentPage == "accueil") {
							if (IsToday(currentTimestampUsed) == true) {
								GetDayDataFromDB(currentTimestampUsed,
												 function(data) {
										DataToDisplay = data;
										InitGauges();
										UpdateGaugesForTimestamp();
									}
								);
							}

							switch (user.dogs[selectedDog].mode) {
								case 1:
									$(".numeric-title").html(
										'<i name="CS000020">' +
											LangItem("CS000020") +
										"</i>"
									);
									break;
								case 2:
									$(".numeric-title").html(
										'<i name="CS000021">' +
											LangItem("CS000021") +
										"</i>"
									);
									break;
								case 3:
									$(".numeric-title").html(
										'<i name="CS000022">' +
											LangItem("CS000022") +
										"</i>"
									);
								break;
								case 4:
									$(".numeric-title").html(
										'<i name="CS000019">' +
												LangItem("CS000019") +
										"</i>"
									);
									break;
							}
							udpdateAvailableDatesArround(
											new Date(currentTimestampUsed));
						} else if (currentPage == "details") {
							if (IsToday(currentTimestampUsed) == true) {
								GetDayDataFromDB(currentTimestampUsed,
												 function(data) {
										DataToDisplay = data;
										DrawHistory(DataToDisplay);
									}
								);
							}
							udpdateAvailableDatesArround(
											new Date(currentTimestampUsed));
						} else if (currentPage == "param") {
							switch (user.dogs[selectedDog].mode) {
								case 1:
									$(".select-penalization").html(
										'<i name="CS000020">' +
											LangItem("CS000020") +
										"</i>"
									);
									break;
								case 2:
									$(".select-penalization").html(
										'<i name="CS000021">' +
											LangItem("CS000021") +
										"</i>"
									);
									break;
								case 3:
									$(".select-penalization").html(
										'<i name="CS000022">' +
											LangItem("CS000022") +
										"</i>"
									);
									break;
								case 4:
									$(".select-penalization").html(
										'<i name="CS000019">' +
											LangItem("CS000019") +
										"</i>"
									);
									break;
							}
						}
					}, ConnectionStatus_Duration);
				} else {
					$("#dog-paw").css({
						opacity: ".2"
					});
					$("#conection-status")
						.parent()
						.css({
							display: "none"
						});
					$("#battery-gauge")
						.parent()
						.css({
							display: "none"
						});
				}
			}

			function UpdateParamStatus() {
				if (BLECurrentlyConnected == false) {
					$(".param-overlay").css({
						display: "block"
					});
				} else {
					$(".param-overlay").css({
						display: "none"
					});
				}
			}

			function AddCloseIcoForSwal(callback) {
				return '<img src="./img/close.svg" ' +
							'style="width: 20px; ' +
								   'position: absolute; ' +
								   'right: -10px; ' +
								   'top: -20px; ' +
								   'border-radius: 10px;" ' +
							'onclick="$(\'.swal2-container\').click();" />';
			}

			function FormatNavTitle(timestamp) {
				var date = new Date(timestamp);
				if (IsToday(timestamp) == true) {
					dateString = '<i name="CS000005">Aujourd\'hui</i>';
				} else {
					dateString =
						("0" + date.getDate()).slice(-2) +
						"/" +
						("0" + (date.getMonth() + 1)).slice(-2) +
						"/" +
						date.getFullYear();
				}
				$(".nav-title").html(dateString);
			}

			function IsToday(timestamp) {
				var date = new Date(timestamp);
				var today = new Date();
				var dateString = "";
				if (today.getDate() == date.getDate() &&
					today.getMonth() == date.getMonth() &&
					today.getFullYear() == date.getFullYear()) {
					return true;
				} else return false;
			}

			// Définir une fonction pour faciliter l'application des styles CSS
			function setCssProperties(element, properties) {
				for (const property in properties) {
					$(element).css(property, properties[property]);
					console.log('La propriété "' + property +
								'" a été définie à "' + properties[property] +
								'" pour "' + element + '"');
				}
			}

			function deviceType(model) {
				switch (device.model)
				{
					case "i386":
					case "x86_64" :
					case "arm64" :
						return "iPhone Simulator";

					case "iPhone1,1" :
						return "iPhone";

					case "iPhone1,2" :
						return "iPhone 3G";

					case "iPhone2,1" :
						return "iPhone 3GS";

					case "iPhone3,1" :
						return "iPhone 4";

					case "iPhone3,2" :
						return "iPhone 4 GSM Rev A";

					case "iPhone3,3" :
						return "iPhone 4 CDMA";

					case "iPhone4,1" :
						return "iPhone 4S";

					case "iPhone5,1" :
						return "iPhone 5 (GSM)";

					case "iPhone5,2" :
						return "iPhone 5 (GSM+CDMA)";

					case "iPhone5,3" :
						return "iPhone 5C (GSM)";

					case "iPhone5,4" :
						return "iPhone 5C (Global)";

					case "iPhone6,1" :
						return "iPhone 5S (GSM)";

					case "iPhone6,2" :
						return "iPhone 5S (Global)";

					case "iPhone7,1" :
						return "iPhone 6 Plus";

					case "iPhone7,2" :
						return "iPhone 6";

					case "iPhone8,1" :
						return "iPhone 6s";

					case "iPhone8,2" :
						return "iPhone 6s Plus";

					case "iPhone8,4" :
						return "iPhone SE (GSM)";

					case "iPhone9,1" :
						return "iPhone 7";

					case "iPhone9,2" :
						return "iPhone 7 Plus";

					case "iPhone9,3" :
						return "iPhone 7";

					case "iPhone9,4" :
						return "iPhone 7 Plus";

					case "iPhone10,1" :
						return "iPhone 8";

					case "iPhone10,2" :
						return "iPhone 8 Plus";

					case "iPhone10,3" :
						return "iPhone X Global";

					case "iPhone10,4" :
						return "iPhone 8";

					case "iPhone10,5" :
						return "iPhone 8 Plus";

					case "iPhone10,6" :
						return "iPhone X GSM";

					case "iPhone11,2" :
						return "iPhone XS";

					case "iPhone11,4" :
						return "iPhone XS Max";

					case "iPhone11,6" :
						return "iPhone XS Max Global";

					case "iPhone11,8" :
						return "iPhone XR";

					case "iPhone12,1" :
						return "iPhone 11";

					case "iPhone12,3" :
						return "iPhone 11 Pro";

					case "iPhone12,5" :
						return "iPhone 11 Pro Max";

					case "iPhone12,8" :
						return "iPhone SE 2nd Gen";

					case "iPhone13,1" :
						return "iPhone 12 Mini";

					case "iPhone13,2" :
						return "iPhone 12";

					case "iPhone13,3" :
						return "iPhone 12 Pro";

					case "iPhone13,4" :
						return "iPhone 12 Pro Max";

					case "iPhone14,2" :
						return "iPhone 13 Pro";

					case "iPhone14,3" :
						return "iPhone 13 Pro Max";

					case "iPhone14,4" :
						return "iPhone 13 Mini";

					case "iPhone14,5" :
						return "iPhone 13";

					case "iPhone14,6" :
						return "iPhone SE 3rd Gen";

					case "iPhone14,7" :
						return "iPhone 14";

					case "iPhone14,8" :
						return "iPhone 14 Plus";

					case "iPhone15,2" :
						return "iPhone 14 Pro";

					case "iPhone15,3" :
						return "iPhone 14 Pro Max";


					case "iPod1,1" :
						return "iPod touch 1st Gen";

					case "iPod2,1" :
						return "iPod touch 2nd Gen";

					case "iPod3,1" :
						return "iPod touch 3rd Gen";

					case "iPod4,1" :
						return "iPod touch 4th Gen";

					case "iPod5,1" :
						return "iPod touch 5th Gen";

					case "iPod7,1" :
						return "iPod touch 6th Gen";

					case "iPod9,1" :
						return "iPod touch 7th Gen";


					case "iPad1,1" :
						return "iPad";

					case "iPad1,2" :
						return "iPad 3G";

					case "iPad2,1" :
						return "2nd Gen iPad";

					case "iPad2,2" :
						return "2nd Gen iPad GSM";

					case "iPad2,3" :
						return "2nd Gen iPad CDMA";

					case "iPad2,4" :
						return "2nd Gen iPad New Revision";

					case "iPad3,1" :
						return "3rd Gen iPad";

					case "iPad3,2" :
						return "3rd Gen iPad CDMA";

					case "iPad3,3" :
						return "3rd Gen iPad GSM";

					case "iPad2,5" :
						return "iPad mini";

					case "iPad2,6" :
						return "iPad mini GSM+LTE";

					case "iPad2,7" :
						return "iPad mini CDMA+LTE";

					case "iPad3,4" :
						return "4th Gen iPad";

					case "iPad3,5" :
						return "4th Gen iPad GSM+LTE";

					case "iPad3,6" :
						return "4th Gen iPad CDMA+LTE";

					case "iPad4,1" :
						return "iPad Air (WiFi)";

					case "iPad4,2" :
						return "iPad Air (GSM+CDMA)";

					case "iPad4,3" :
						return "iPad Air 1st Gen (China)";

					case "iPad4,4" :
						return "iPad mini Retina (WiFi)";

					case "iPad4,5" :
						return "iPad mini Retina (GSM+CDMA)";

					case "iPad4,6" :
						return "iPad mini Retina (China)";

					case "iPad4,7" :
						return "iPad mini 3 (WiFi)";

					case "iPad4,8" :
						return "iPad mini 3 (GSM+CDMA)";

					case "iPad4,9" :
						return "iPad Mini 3 (China)";

					case "iPad5,1" :
						return "iPad mini 4 (WiFi)";

					case "iPad5,2" :
						return "4th Gen iPad mini (WiFi+Cellular)";

					case "iPad5,3" :
						return "iPad Air 2 (WiFi)";

					case "iPad5,4" :
						return "iPad Air 2 (Cellular)";

					case "iPad6,3" :
						return "iPad Pro (9.7 inch, WiFi)";

					case "iPad6,4" :
						return "iPad Pro (9.7 inch, WiFi+LTE)";

					case "iPad6,7" :
						return "iPad Pro (12.9 inch, WiFi)";

					case "iPad6,8" :
						return "iPad Pro (12.9 inch, WiFi+LTE)";

					case "iPad6,11" :
						return "iPad (2017)";

					case "iPad6,12" :
						return "iPad (2017)";

					case "iPad7,1" :
						return "iPad Pro 2nd Gen (WiFi)";

					case "iPad7,2" :
						return "iPad Pro 2nd Gen (WiFi+Cellular)";

					case "iPad7,3" :
						return "iPad Pro 10.5-inch 2nd Gen";

					case "iPad7,4" :
						return "iPad Pro 10.5-inch 2nd Gen";

					case "iPad7,5" :
						return "iPad 6th Gen (WiFi)";

					case "iPad7,6" :
						return "iPad 6th Gen (WiFi+Cellular)";

					case "iPad7,11" :
						return "iPad 7th Gen 10.2-inch (WiFi)";

					case "iPad7,12" :
						return "iPad 7th Gen 10.2-inch (WiFi+Cellular)";

					case "iPad8,1" :
						return "iPad Pro 11 inch 3rd Gen (WiFi)";

					case "iPad8,2" :
						return "iPad Pro 11 inch 3rd Gen (1TB, WiFi)";

					case "iPad8,3" :
						return "iPad Pro 11 inch 3rd Gen (WiFi+Cellular)";

					case "iPad8,4" :
						return "iPad Pro 11 inch 3rd Gen (1TB, WiFi+Cellular)";

					case "iPad8,5" :
						return "iPad Pro 12.9 inch 3rd Gen (WiFi)";

					case "iPad8,6" :
						return "iPad Pro 12.9 inch 3rd Gen (1TB, WiFi)";

					case "iPad8,7" :
						return "iPad Pro 12.9 inch 3rd Gen (WiFi+Cellular)";

					case "iPad8,8" :
						return "iPad Pro 12.9 inch 3rd Gen (1TB, WiFi+Cellular)";

					case "iPad8,9" :
						return "iPad Pro 11 inch 4th Gen (WiFi)";

					case "iPad8,10" :
						return "iPad Pro 11 inch 4th Gen (WiFi+Cellular)";

					case "iPad8,11" :
						return "iPad Pro 12.9 inch 4th Gen (WiFi)";

					case "iPad8,12" :
						return "iPad Pro 12.9 inch 4th Gen (WiFi+Cellular)";

					case "iPad11,1" :
						return "iPad mini 5th Gen (WiFi)";

					case "iPad11,2" :
						return "iPad mini 5th Gen";

					case "iPad11,3" :
						return "iPad Air 3rd Gen (WiFi)";

					case "iPad11,4" :
						return "iPad Air 3rd Gen";

					case "iPad11,6" :
						return "iPad 8th Gen (WiFi)";

					case "iPad11,7" :
						return "iPad 8th Gen (WiFi+Cellular)";

					case "iPad12,1" :
						return "iPad 9th Gen (WiFi)";

					case "iPad12,2" :
						return "iPad 9th Gen (WiFi+Cellular)";

					case "iPad14,1" :
						return "iPad mini 6th Gen (WiFi)";

					case "iPad14,2" :
						return "iPad mini 6th Gen (WiFi+Cellular)";

					case "iPad13,1" :
						return "iPad Air 4th Gen (WiFi)";

					case "iPad13,2" :
						return "iPad Air 4th Gen (WiFi+Cellular)";

					case "iPad13,4" :
						return "iPad Pro 11 inch 5th Gen";

					case "iPad13,5" :
						return "iPad Pro 11 inch 5th Gen";

					case "iPad13,6" :
						return "iPad Pro 11 inch 5th Gen";

					case "iPad13,7" :
						return "iPad Pro 11 inch 5th Gen";

					case "iPad13,8" :
						return "iPad Pro 12.9 inch 5th Gen";

					case "iPad13,9" :
						return "iPad Pro 12.9 inch 5th Gen";

					case "iPad13,10" :
						return "iPad Pro 12.9 inch 5th Gen";

					case "iPad13,11" :
						return "iPad Pro 12.9 inch 5th Gen";

					case "iPad13,16" :
						return "iPad Air 5th Gen (WiFi)";

					case "iPad13,17" :
						return "iPad Air 5th Gen (WiFi+Cellular)";

					case "iPad13,18" :
						return "iPad 10th Gen";

					case "iPad13,19" :
						return "iPad 10th Gen";

					case "iPad14,3" :
						return "iPad Pro 11 inch 4th Gen";

					case "iPad14,4" :
						return "iPad Pro 11 inch 4th Gen";

					case "iPad14,5" :
						return "iPad Pro 12.9 inch 6th Gen";

					case "iPad14,6" :
						return "iPad Pro 12.9 inch 6th Gen";


					case "Watch1,1" :
						return "Apple Watch 38mm case";

					case "Watch1,2" :
						return "Apple Watch 42mm case";

					case "Watch2,6" :
						return "Apple Watch Series 1 38mm case";

					case "Watch2,7" :
						return "Apple Watch Series 1 42mm case";

					case "Watch2,3" :
						return "Apple Watch Series 2 38mm case";

					case "Watch2,4" :
						return "Apple Watch Series 2 42mm case";

					case "Watch3,1" :
						return "Apple Watch Series 3 38mm case (GPS+Cellular)";

					case "Watch3,2" :
						return "Apple Watch Series 3 42mm case (GPS+Cellular)";

					case "Watch3,3" :
						return "Apple Watch Series 3 38mm case (GPS)";

					case "Watch3,4" :
						return "Apple Watch Series 3 42mm case (GPS)";

					case "Watch4,1" :
						return "Apple Watch Series 4 40mm case (GPS)";

					case "Watch4,2" :
						return "Apple Watch Series 4 44mm case (GPS)";

					case "Watch4,3" :
						return "Apple Watch Series 4 40mm case (GPS+Cellular)";

					case "Watch4,4" :
						return "Apple Watch Series 4 44mm case (GPS+Cellular)";

					case "Watch5,1" :
						return "Apple Watch Series 5 40mm case (GPS)";

					case "Watch5,2" :
						return "Apple Watch Series 5 44mm case (GPS)";

					case "Watch5,3" :
						return "Apple Watch Series 5 40mm case (GPS+Cellular)";

					case "Watch5,4" :
						return "Apple Watch Series 5 44mm case (GPS+Cellular)";

					case "Watch5,9" :
						return "Apple Watch SE 40mm case (GPS)";

					case "Watch5,10" :
						return "Apple Watch SE 44mm case (GPS)";

					case "Watch5,11" :
						return "Apple Watch SE 40mm case (GPS+Cellular)";

					case "Watch5,12" :
						return "Apple Watch SE 44mm case (GPS+Cellular)";

					case "Watch6,1" :
						return "Apple Watch Series 6 40mm case (GPS)";

					case "Watch6,2" :
						return "Apple Watch Series 6 44mm case (GPS)";

					case "Watch6,3" :
						return "Apple Watch Series 6 40mm case (GPS+Cellular)";

					case "Watch6,4" :
						return "Apple Watch Series 6 44mm case (GPS+Cellular)";

					case "Watch6,6" :
						return "Apple Watch Series 7 41mm case (GPS)";

					case "Watch6,7" :
						return "Apple Watch Series 7 45mm case (GPS)";

					case "Watch6,8" :
						return "Apple Watch Series 7 41mm case (GPS+Cellular)";

					case "Watch6,9" :
						return "Apple Watch Series 7 45mm case (GPS+Cellular)";

					case "Watch6,10" :
						return "Apple Watch SE 40mm case (GPS)";

					case "Watch6,11" :
						return "Apple Watch SE 44mm case (GPS)";

					case "Watch6,12" :
						return "Apple Watch SE 40mm case (GPS+Cellular)";

					case "Watch6,13" :
						return "Apple Watch SE 44mm case (GPS+Cellular)";

					case "Watch6,14" :
						return "Apple Watch Series 8 41mm case (GPS)";

					case "Watch6,15" :
						return "Apple Watch Series 8 45mm case (GPS)";

					case "Watch6,16" :
						return "Apple Watch Series 8 41mm case (GPS+Cellular)";

					case "Watch6,17" :
						return "Apple Watch Series 8 45mm case (GPS+Cellular)";

					case "Watch6,18" :
						return "Apple Watch Ultra";


					default:
						return device.model;
				}
			}

			function SimulSelection() {
				simuleAndroid = simuleAndroid == 0 ? 1 : 0;;
				OrientationSizeChange();
			}

			function OrientationSizeChange() {
				if (app.isInitialized == true) {
					console.log("OrientationSizeChange");

					//*** Des zones réservées qui tourne avec le téléphone	 ***
					//*** comme la caméra en haut de l'écran.				 ***

					var hautRot = 59;
					var droiteRot = 0;
					var basRot = 0;
					var gaucheRot = 0;

					//*** Des zones réservées qui ne tourne pas avec le		 ***
					//*** téléphone comme la barre de fin d'application.	 ***

					var haut = 0;
					var droite = 0;
					var bas = 34;
					var gauche = 0;

					var deltaAcceuilL = 0;
					var deltaAcceuilP = 0;
					var deltaDetailL = 0;
					var deltaDetailP = 0;
					var deltaParamL = 0;
					var deltaParamP = 0;

					//*** On initialise ces zones réservés en fonction de	 ***
					//*** la plateforme et du modèle de l'appareil.			 ***

					console.log(device.model);
					var name = deviceType(device.model);
					console.log(name);

					if (device.platform == "iOS") {
						if ((name == "iPhone") ||
							(name.substring(0, 8) == "iPhone 3") ||
							(name.substring(0, 8) == "iPhone 4") ||
							(name.substring(0, 8) == "iPhone 5") ||
							(name.substring(0, 8) == "iPhone 6") ||
							(name.substring(0, 8) == "iPhone 7") ||
							(name.substring(0, 8) == "iPhone 8") ||
							(name.substring(0, 9) == "iPhone SE") ||
							(name.substring(0, 11) == "iPad (2017)") ||
							(name.substring(0, 12) == "iPad 6th Gen") ||
							(name.substring(0, 12) == "iPad 7th Gen") ||
							(name.substring(0, 12) == "iPad 8th Gen") ||
							(name.substring(0, 12) == "iPad 9th Gen") ||
							(name.substring(0, 13) == "iPad Air (GSM") ||
							(name.substring(0, 14) == "iPad Air (WiFi") ||
							(name.substring(0, 10) == "iPad Air 2") ||
							(name.substring(0, 16) == "iPad Air 3rd Gen") ||
							(name.substring(0, 12) == "iPad Pro (9.") ||
							(name.substring(0, 11) == "iPad Pro 10") ||
							(name.substring(0, 12) == "iPad Pro (12") ||
							(name.substring(0, 12) == "iPad Pro 2nd") ||
							(name.substring(0, 10) == "iPod touch")) {
							hautRot = 0;
							bas = 0;
						} else if (
							(name.substring(0, 13) == "iPad 10th Gen") ||
							(name.substring(0, 16) == "iPad Air 4th Gen") ||
							(name.substring(0, 16) == "iPad Air 5th Gen") ||
							(name.substring(0, 11) == "iPad Pro 11") ||
							(name.substring(0, 11) == "iPad Pro 12") ||
							(name.substring(0, 9) == "iPad mini")) {
							hautRot = 0;
							bas = 15;
						} else if (name.substring(0, 9) == "iPhone XR") {
							hautRot = 33;
							bas = 15;
						} else if (name.substring(0, 8) == "iPhone X") {
							hautRot = 30;   // 47 Safe
							bas = 15;
						} else if (name.substring(0, 13) == "iPhone 11 Pro") {
							hautRot = 30;
							bas = 15;
						} else if (name.substring(0, 9) == "iPhone 11") {
							hautRot = 33;
							bas = 15;
						} else if (name.substring(0, 14) == "iPhone 12 Mini") {
							hautRot = 34;
							bas = 15;
						} else if (name.substring(0, 9) == "iPhone 12") {
							hautRot = 31;
							bas = 15;
						} else if (name.substring(0, 14) == "iPhone 13 Mini") {
							hautRot = 37;
							bas = 15;
						} else if (name.substring(0, 9) == "iPhone 13") {
							hautRot = 33;
							bas = 15;
						} else if (name.substring(0, 13) == "iPhone 14 Pro") {
							hautRot = 48;
							bas = 15;
						} else if (name.substring(0, 9) == "iPhone 14") {
							hautRot = 33;
							bas = 15;
						} else if (name.substring(0, 6) == "iPhone") {
							hautRot = 59;
							bas = 34;
						}

//						deltaAcceuilL = 0;
//						deltaAcceuilP = -20;
//						deltaDetailL = 0;
//						deltaDetailP = 24;
//						deltaParamL = 0; //-18;
//						deltaParamP = -20; //-41;
					} else if (device.platform == "Android") {
						hautRot = 0;
						bas = 0;

//						deltaAcceuilL = 0;
//						deltaAcceuilP = -20;
//						deltaDetailL = -12;
//						deltaDetailP = -20;
//						deltaParamL = 0;
//						deltaParamP = 0;
					} else if (device.platform == "browser") {
						if (simuleAndroid == -1) {
							simuleAndroid = name == "Safari" ? 0 : 1;
						}

						hautRot = 59;
						bas = 34;

//						deltaAcceuilL = 0;
//						deltaAcceuilP = -20;
//						deltaDetailL = -12;
//						deltaDetailP = -20;
//						deltaParamL = 0;
//						deltaParamP = 0;
					}

					// Pour les cas ou pas renseigné par une platforme
					var type = "" ;
					var withOrientation = true;
					if (screen.orientation != null &&
						screen.orientation.type != null ) {
						type += screen.orientation.type;
					} else {
						withOrientation = false;
					}

					if (device.platform == "iOS") {
						if (name.includes("ipad")) {
							if (window.innerWidth >= window.innerHeight &&
								type != "portrait-primary" &&
								type != "portrait-secondary") {
								type = "portrait-primary";
							}
							if (window.innerWidth < window.innerHeight &&
								type != "landscape-primary" &&
								type != "landscape-secondary") {
								type = "landscape-primary";
							}
						} else {
							if (window.innerWidth < window.innerHeight &&
								type != "portrait-primary" &&
								type != "portrait-secondary") {
								type = "portrait-primary";
							}
							if (window.innerWidth >= window.innerHeight &&
								type != "landscape-primary" &&
								type != "landscape-secondary") {
								type = "landscape-primary";
							}
						}
					} else {
						if (window.innerWidth < window.innerHeight &&
							type != "portrait-primary" &&
							type != "portrait-secondary") {
							type = "portrait-primary";
						}
						if (window.innerWidth >= window.innerHeight &&
							type != "landscape-primary" &&
							type != "landscape-secondary") {
							type = "landscape-primary";
						}
					}

					console.log(window.innerWidth + "x" + window.innerHeight);
					console.log(type);

					// si l'orientation est incertaine (à ± 1/2 tour) on protége
					// au maximum les zones symétriques qui peuvent tourner
					withOrientation = false;
					if (!withOrientation) {
						hautRot = Math.max(hautRot, basRot);
						basRot = hautRot;
						droiteRot = Math.max(droiteRot, gaucheRot);
						gaucheRot = droiteRot;
					}

					// On calcul la taille des 4 zones réservées en fonction
					// de l'orientation actuelle du téléphone en tenant compte
					// des zones qui tourne et de celle qui sont fixes
					var h = 0;
					var d = 0;
					var b = 0;
					var g = 0;
					if (type == "landscape-primary") {
						// rotation 1/4 tour à droite
						h = Math.max(gaucheRot, haut);
						d = Math.max(hautRot, droite);
						b = Math.max(droiteRot, bas);
						g = Math.max(basRot, gauche);
					} else if (type == "landscape-secondary") {
						// rotation 1/4 tour à gauche
						h = Math.max(droiteRot, haut);
						d = Math.max(basRot, droite);
						b = Math.max(gaucheRot, bas);
						g = Math.max(hautRot, gauche);
					} else if (type == "portrait-primary") {
						// pas de rotation
						h = Math.max(hautRot, haut);
						d = Math.max(droiteRot, droite);
						b = Math.max(basRot, bas);
						g = Math.max(gaucheRot, gauche);
					} else {
						// rotation 1/2 tour
						h = Math.max(basRot, haut);
						d = Math.max(gaucheRot, droite);
						b = Math.max(hautRot, bas);
						g = Math.max(droiteRot, gauche);
					}

					console.log(h + ", " + d + ", " + b + ", " + g);

					// la hauteur des barres communes aux pages acceuil, details
					// et param (non présente dans les pages index)
					var fixe = $('.top-bar').outerHeight(true) +
							   $('.nav-bar').outerHeight(true) +
							   $('.bottom-bar').outerHeight(true);
					// la hauteur de la barre d'outils supplémentaire de la page
					// détail
					var toolBar = $('.details-toolbar').outerHeight(true) + 10;

					var botBar = $('.bottom-bar').outerHeight(true);

					console.log("fixe = " + fixe);
					console.log("h + b = " + (h + b));
					console.log("toolBar = " + toolBar);

					// Règle la taille de La zone réservées à affichée en haut
					$(".reserved-haut").css({
						position: "relative",
						width: "calc(100vw - " + (d + g) + "px)",
						left: g + "px",
						"min-height": h + "px",
						background: "#f8a929"
					});

					// Règle la taille de La zone réservées à affichée en bas
					$(".reserved-bas").css({
						position: "absolute",
						width: "calc(100vw - " + (d + g) + "px)",
						left: g + "px",
						"min-height": b + "px",
						background: "#f8a929"
					});

					// La page d'index qui n'a pas de barre de commande/status
					// en bas pour le retour à la page d'index
					if (currentPage == "index") {
						$(".bottom-bar").css({
							display: "none"
						});
						// Règle la taille des zone réservées à affichée à
						// droite et/ou à gauche
						$(".zone-travail").css({
							position: "relative",
							width: "calc(100vw - " + (d + g) + "px)",
							left: g + "px",
							"max-height": "calc(100vh - " + (h + b) + "px)",
							"min-height": "calc(100vh - " + (h + b) + "px)",
							"overflow-y": "auto"
						});
					// Les autres pages qui ont une barre de commandes/status
					// en bas pour revenir à la page d'index
					} else {
						$(".bottom-bar").css({
							display: "block"
						});
						// Règle la taille des zone réservées, à affichée à
						// droite et/ou à gauche
						$(".zone-travail").css({
							position: "relative",
							width: "calc(100vw - " + (d + g) + "px)",
							left: g + "px",
							"max-height": "calc(100vh - " +
												(h + b + botBar) + "px)",
							"min-height": "calc(100vh - " + (h + b) + "px)",
							"overflow-y": "hidden"
						});

						// Modifie les tailles des contenus qui font l'objet
						// d'un défillement dans les différentes pages
						$('#day-abstract').css({
							height: "375px",
							"max-height": "calc(100vh - " +
												(h + b + fixe +
												 deltaAcceuilL) + "px)",
						});
						$('.details-content').css({
							"max-height": "calc(100vh - " +
												(h + b + fixe +
												 deltaDetailL) + "px)",
							"overflow-y": "auto"
						});
						$('.day-history-content').css({
							"max-height": "calc(100vh - " +
												(h + b + fixe + toolBar +
												 deltaDetailL) + "px)",
							"min-height": "70px",
						});
						$('#param-content').css({
							"max-height": "calc(100vh - " +
												(h + b + fixe +
												 deltaParamL) +"px)",
						});
						var hOver = $('.param-connected').outerHeight(false) -
									$('.end-of-param').outerHeight(false);
						$('.param-overlay').css({
							"height": hOver + "px"
						});
					}

					// gère la positon des contenus simulés des zones réservés
					// pour le navigateur qui ne possède pas la caméra, les
					// barres d'outils des téléphones.
					if (device.platform == "browser") {
						if (simuleAndroid) {
							// on simule la caméra Android
							$('.camera-ecran').css({
								height: "30px",
								width: "30px",
								"border-radius": "15px",
								display: "block"
							});
							// et les outils Android
							$(".reserved-bas").css({
								display: "flex"
							});
							$('.reserved-bas-barre').css({
								display: "none"
							});
							$('.reserved-bas-tools').css({
								display: "flex"
							});

							if (type == "landscape-primary") {
								$('.camera-ecran').css({
									top: "calc(50vh - 15px)",
									left: "calc(100vw - 45px)"
								});
							} else if (type == "landscape-secondary") {
								$('.camera-ecran').css({
									top: "calc(50vh - 15px)",
									left: "15px"
								});
							} else if (type == "portrait-primary") {
								$('.camera-ecran').css({
									top: "15px",
									left: "calc(50vw - 15px)"
								});
							} else if (type == "portrait-secondary") {
								$('.camera-ecran').css({
									top: "calc(100vh - 45px)",
									left: "calc(50vw - 15px)"
								});
							}
						} else {
							// on simule la caméra Apple
							if (type == "landscape-primary") {
								$('.camera-ecran').css({
									height: "250px",
									width: "30px",
									"border-radius": "15px 0 0 15px",
									display: "block",
									top: "calc(50vh - 125px)",
									left: "calc(100vw - 30px)"
								});
							} else if (type == "landscape-secondary") {
								$('.camera-ecran').css({
									height: "250px",
									width: "30px",
									"border-radius": "15px 0 0 15px",
									display: "block",
									top: "calc(50vh - 125px)",
									left: "0"
								});
							} else if (type == "portrait-primary") {
								$('.camera-ecran').css({
									height: "30px",
									width: "250px",
									"border-radius": "0 0 15px 15px",
									display: "block",
									top: "0",
									left: "calc(50vw - 125px)"
								});
							} else if (type == "portrait-secondary") {
								$('.camera-ecran').css({
									height: "250px",
									width: "30px",
									"border-radius": "0 0 15px 15px",
									display: "block",
									top: "calc(100vh - 30px)",
									left: "calc(50vw - 125px)"
								});
							}
							// et les outils Apple
							$(".reserved-bas").css({
								display: "flex"
							});
							$('.reserved-bas-barre').css({
								display: "flex"
							});
							$('.reserved-bas-tools').css({
								display: "none"
							});
						}
					} else {
						$('.camera-ecran').css({
							display: "none"
						});
						$('.reserved-bas-barre').css({
							display: "none"
						});
						$('.reserved-bas-tools').css({
							display: "none"
						});
						$(".reserved-bas").css({
							display: "flex"
						});
					}

					if (window.innerWidth > 380) {
						$('.scheduler-selection-cluster').css({
							"font-size": "12px"
						});
					} else if (window.innerWidth > 335) {
						$('.scheduler-selection-cluster').css({
							"font-size": "10px"
						});
					} else {
						$('.scheduler-selection-cluster').css({
							"font-size": "8px"
						});
					}

				} else setTimeout(OrientationSizeChange, 100);
			}
		</script>
	</head>

	<body>
		<div id="reserved-haut" class="reserved-haut">
		</div>
		<div id="zone-travail" class="zone-travail">
			<div id="main-container" class="main-container">
				<div class="entry-top">
					<div class="entry-app-name">
						<span>Canicalm</span><br>&nbsp;Smart
					</div>
					<img class="entry-pic" src="./img/entry-pic.png">
					<div class="entry-by">
						by <img src="./img/logo-numaxes.svg" />
					</div>
				</div>
				<div id="entry-content" class="entry-content">
				</div>
			</div>
		<div class="bottom-bar">
			<img class="bottom-bar-img-out" src="./img/out.svg" '
				 onclick="LoadPage('index');" />
			<span>
				<img id="dog-paw" src="./img/dog-paw.svg"
					 onclick="demoConnect();" />
			</span>
			<span>
				<img id="battery-gauge" src="./img/battery-gauge.svg" />
			</span>
			<span>
				<img id="conection-status" src="./img/check.svg" />
			</span>
		</div>
		</div>
		<div id="reserved-bas" class="reserved-bas">
			<div id="reserved-bas-barre" class="reserved-bas-barre"
				 onclick="SimulSelection();">
			</div>
			<div id="reserved-bas-tools" class="reserved-bas-tools">
				<div id="reserved-bas-square" class="reserved-bas-square"
					 onclick="SimulSelection();">
					</div>
				<div id="reserved-bas-sep" class="reserved-bas-sep">
				</div>
				<div id="reserved-bas-round" class="reserved-bas-round"
					 onclick="SimulSelection();">
				</div>
				<div id="reserved-bas-sep" class="reserved-bas-sep">
				</div>
				<div id="reserved-bas-triangle" class="reserved-bas-triangle"
					 onclick="SimulSelection();">
				</div>
			</div>
		</div>
		<div id="camera-ecran" class="camera-ecran"
			 onclick="SimulSelection();">
		</div>
	</body>
</html>
